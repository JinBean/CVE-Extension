# CVE Extensions

This repository is an extension of our research on cryptocurrency clones and vulnerabilities that takes existing vulnerabilities in major coins and uses clone detection tools as a method of identifying propagations of these vulnerabilities in other coins.

List of documented CVEs
1. [CVE-2018-17144](#cve-2018-17144)
2. [CVE-2019-7167](#cve-2019-7167)

-------

## CVE-2018-17144

[National Vulnerability Database (NVD) Report](https://nvd.nist.gov/vuln/detail/CVE-2018-17144)

A reachable assert statement in Bitcoin Core allows a remote denial of service (application crash) exploitable by miners via attempting to double-spend a transaction insinde a mined block. This CVE also later leads to an inflation bug, which we do not focus on here.

The code relevant to this vulnerability can be found in the file `validation.cpp` of Bitcoin Core 0.14.X.
This specific file can be found [here](https://github.com/JinBean/CVE-Extension/tree/master/CVE-2018-17144/Bitcoin-0.14.X).

When a block containing a double spent transaction is validated, it skips the duplicate input check because of the false parameter [here](https://github.com/JinBean/CVE-Extension/blob/master/CVE-2018-17144/Bitcoin-0.14.X/validation.cpp#L2883). The double spend will reach the function [UpdateCoins()](https://github.com/JinBean/CVE-Extension/blob/master/CVE-2018-17144/Bitcoin-0.14.X/validation.cpp#L1323), and the inputs to the transaction are being marked as spent in the Unspent Transaction Output(UTXO) database. The first time the transaction is seen, the coins involved are marked as spent. Since the coins involved in the transaction are already marked as spent, the second time the transaction is seen, `coins->vout[nPos].IsNull()` will be true. It will then enter this [if statement](https://github.com/JinBean/CVE-Extension/blob/master/CVE-2018-17144/Bitcoin-0.14.X/validation.cpp#L1332) and subsequently execute the assert statement that follows. The assert then causes the node to crash, resulting in the denial of service vulerability. (Paraphrased from Source 2)

The coin(s) that we found to still contain this vulnerability as of 26/3/2019 include:

  * [Irlecoin](https://github.com/irlecoin/irlecoin)
  * [MinexCoin](https://github.com/minexcoin/minexcoin) (Fixed)
  * [MktCoin](https://github.com/mktcoin/mktcoin)
  * [PlatinCoin](https://github.com/platincoin-project/platincoin)
  * [QuasarCoin](https://github.com/quasarcoin/quasar)
  * [TCOIN](https://github.com/koba24/tcoin)
  
 These coin(s) still contain unpatched instances of the vulnerability in their code base which can be found [here](https://github.com/JinBean/CVE-Extension/tree/master/CVE-2018-17144)
 
 
 ### Sources:
 1. [CVE-2018-17144 Full Disclosure](https://bitcoincore.org/en/2018/09/20/notice/)
 2. [Andrew Chow, Bitcoin StackExchange](https://bitcoin.stackexchange.com/questions/79481/how-does-the-most-recently-found-critical-vulnerability-cve-2018-17144-work/79484#79484)
 
-------

## CVE-2019-7167

[National Vulnerability Database (NVD) Report](https://nvd.nist.gov/vuln/detail/CVE-2019-7167)

BCTV14 setup produces elements that violate soundness, misleading the original Sprout zk-SNARK verifier into accepting the correctness of a transaction. This allows an attacker to create very large, virtually unlimited amounts of counterfeit shielded tokens without detection. Zcash has switched to different parameters using a new “Sprout-on-Groth16” proving system as of the Sapling network upgrade on October 28th 2018, and so is not affected by the bug. 

The code relevant to this vulnerability can be found in the file `JoinSplit.cpp` of Zcash 1.X.
This specific file can be found [here](https://github.com/JinBean/CVE-Extension/blob/master/CVE-2019-7167/Zcash-1.X/JoinSplit.cpp).

The coin(s) that we found to still contain this vulnerability as of 27/5/2019 include:

 * [Hush](https://github.com/MyHush/hush)
 
 These coin(s) still contain unpatched instances of the vulnerability in their code base which can be found [here](https://github.com/JinBean/CVE-Extension/tree/master/CVE-2019-7167)


### Sources:
1. [Zcash blog disclosure])(https://z.cash/blog/zcash-counterfeiting-vulnerability-successfully-remediated/)
 
-------
*All files uploaded have been cloned from their respective coin repositories.
