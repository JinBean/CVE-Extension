# CVE Extensions

This repository is an extension of our research on cryptocurrency clones and vulnerabilities that takes existing vulnerabilities in major coins and uses clone detection tools as a method of identifying propagations of these vulnerabilities in other coins.

-------

## CVE-2018-17144

A reachable assert statement in Bitcoin Core allows a remote denial of service (application crash) exploitable by miners via attempting to double-spend a transaction insinde a mined block. This CVE also later leads to an inflation bug, which we do not focus on here.

The code relevant to this bug can be found in the file `validation.cpp` of Bitcoin Core 0.14.X.
This specific file can be found [here](https://github.com/JinBean/CVE-Extension/tree/master/CVE-2018-17144/Bitcoin-0.14.X).

When a block containing a double spent transaction is validated, it skips the duplicate input check because of the false parameter [here](https://github.com/JinBean/CVE-Extension/blob/master/CVE-2018-17144/Bitcoin-0.14.X/validation.cpp#L2883). The double spend will reach the function [UpdateCoins()](https://github.com/JinBean/CVE-Extension/blob/master/CVE-2018-17144/Bitcoin-0.14.X/validation.cpp#L1323), and the inputs to the transaction are being marked as spent in the Unspent Transaction Output(UTXO) database. The first time the transaction is seen, the coins involved are marked as spent. Since the coins involved in the transaction are already marked as spent, the second time the transaction is seen, `coins->vout[nPos].IsNull()` will be true. It will then enter this [if statement](https://github.com/JinBean/CVE-Extension/blob/master/CVE-2018-17144/Bitcoin-0.14.X/validation.cpp#L1332) and subsequently execute the assert statement that follows. The assert then causes the node to crash, resulting in the denial of service vulerability. (Paraphrased from Source 1)

The coins that we found to still contain this denial of service bug as of 26/3/2019 include:

  * [Irlecoin](https://github.com/irlecoin/irlecoin)
  * [MinexCoin](https://github.com/minexcoin/minexcoin)
  * [MktCoin](https://github.com/mktcoin/mktcoin)
  * [PlatinCoin](https://github.com/platincoin-project/platincoin)
  * [QuasarCoin](https://github.com/quasarcoin/quasar)
  * [TCOIN](https://github.com/koba24/tcoin)
  
 These coins all still contain parts of the code base that are relevant to the vulnerability and are listed [here](https://github.com/JinBean/CVE-Extension/tree/master/CVE-2018-17144)
 
 
 ### Sources:
 1. [CVE-2018-17144 Full Disclosure](https://bitcoincore.org/en/2018/09/20/notice/)
 1. [Andrew Chow, Bitcoin StackExchange](https://bitcoin.stackexchange.com/questions/79481/how-does-the-most-recently-found-critical-vulnerability-cve-2018-17144-work/79484#79484)
 
 *All files uploaded have been cloned from their respective coin repositories.
 
-------
